<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>IKEA SMÅGÖRA Assembly - Step 2: Assemble end panels</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }

        #info {
            position: absolute;
            top: 10px;
            width: 100%;
            text-align: center;
            font-family: Arial, sans-serif;
            pointer-events: none;
            color: #333;
        }

        #instructions {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        #sub-instructions {
            font-size: 0.9em;
            color: #555;
        }
    </style>
</head>

<body>
    <div id="info">
        <div id="instructions">Step 2: Assemble the end panels</div>
        <div id="sub-instructions">Attach feet or bottom rails to the end panels using screws and dowels.</div>
    </div>
    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xe0e0e0);
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 100, 100);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.target.set(0, 0, 0);
        controls.update();

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6); scene.add(ambientLight);
        const dirLight = new THREE.DirectionalLight(0xffffff, 1.0);
        dirLight.position.set(50, 200, 100); dirLight.castShadow = true;
        dirLight.shadow.mapSize.set(2048, 2048); scene.add(dirLight);
        const ground = new THREE.Mesh(new THREE.PlaneGeometry(300, 300), new THREE.MeshStandardMaterial({ color: 0xb0b0b0, roughness: 1.0 }));
        ground.rotation.x = -Math.PI / 2; ground.position.y = -0.1; ground.receiveShadow = true; scene.add(ground);

        const whiteWoodMat = new THREE.MeshStandardMaterial({ color: 0xffffff, roughness: 0.6, metalness: 0.1 });

        function createEndPanel() {
            const width = 70; const height = 75; const thickness = 2.5;
            const shape = new THREE.Shape();
            shape.moveTo(-width / 2, -height / 2);
            shape.lineTo(width / 2, -height / 2);
            shape.lineTo(width / 2, height / 2 - 10);
            shape.quadraticCurveTo(0, height / 2, -width / 2, height / 2 - 10);
            shape.lineTo(-width / 2, -height / 2);
            const geo = new THREE.ExtrudeGeometry(shape, { depth: thickness, bevelEnabled: false });
            geo.center();
            const mesh = new THREE.Mesh(geo, whiteWoodMat); mesh.castShadow = true; return mesh;
        }

        function createFoot() {
            const geo = new THREE.BoxGeometry(5, 2, 5);
            const mesh = new THREE.Mesh(geo, whiteWoodMat); mesh.castShadow = true; return mesh;
        }

        // --- ASSEMBLY ---
        const end1 = createEndPanel();
        end1.rotation.x = -Math.PI / 2;
        end1.position.set(0, 1.25, 0);
        scene.add(end1);

        // Feet at bottom corners (Z = 37.5 approx)
        const foot1 = createFoot(); foot1.position.set(-30, 5, 37.5); scene.add(foot1);
        const foot2 = createFoot(); foot2.position.set(30, 5, 37.5); scene.add(foot2);

        function animate() {
            requestAnimationFrame(animate);
            if (foot1.position.y > 1.25) foot1.position.y -= 0.1;
            if (foot2.position.y > 1.25) foot2.position.y -= 0.1;
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
        window.addEventListener('resize', () => { camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); });
    </script>
</body>

</html>